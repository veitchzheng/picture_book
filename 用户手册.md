# PDF小册子裁剪工具 - 用户手册

## 📖 简介

PDF小册子裁剪工具是一个专门为打印小册子设计的智能PDF处理工具。它能够自动识别PDF的封面和正文页面，进行智能裁剪和重新排列，优化打印效果。

### 🎯 主要功能
- **封面识别**：自动识别第一页和最后一页作为封面/封底
- **横版裁剪**：将横版双页排版的正文件裁剪为单页
- **方向调整**：封面页自动转为纵版显示
- **顺序优化**：按正确顺序输出新PDF文件

---

## 🚀 快速开始

### 环境要求
- Python 3.7+
- macOS / Windows / Linux

### 安装步骤

1. **下载项目**
```bash
cd /Users/veitch/github/picture_book
```

2. **安装依赖**
```bash
pip3 install -r requirements.txt
```

3. **启动应用**
```bash
python3 app.py
```

4. **访问应用**
打开浏览器访问：`http://localhost:5001`

---

## 📱 使用指南

### 1. 上传PDF文件

**方法一：点击上传**
- 点击页面中央的"点击选择PDF文件或拖拽到此处"区域
- 在弹出的文件选择器中选择您的PDF文件

**方法二：拖拽上传**
- 直接将PDF文件拖拽到上传区域
- 支持单个文件上传（最大16MB）

### 2. 查看文件信息
上传成功后，页面会显示：
- 文件名
- 文件大小
- "开始处理"按钮变为可用状态

### 3. 开始处理
点击"开始处理"按钮，系统将自动：
- 分析PDF结构
- 裁剪横版页面
- 调整封面方向
- 重新排列页面顺序

### 4. 下载结果
处理完成后，页面将显示：
- ✅ 成功图标
- 原文件信息
- 处理内容说明
- "下载裁剪后的PDF"按钮

点击下载按钮即可获得优化后的PDF文件。

---

## 🔧 技术规格

### 支持的PDF格式
- 标准PDF 1.4+ 格式
- 包含文本和图像的PDF
- 单页或多页PDF

### 文件限制
- **最大文件大小**：16MB
- **最小页数**：3页（封面+至少1页正文+封底）
- **支持语言**：中文、英文等Unicode字符

### 处理规则

#### 封面处理
```
原始PDF：
第1页（封面） → 转为纵版
第2页到第N-1页（正文） → 横版对半裁剪
第N页（封底） → 转为纵版
```

#### 横版裁剪逻辑
```
横版页面（宽度 > 高度）：
┌─────────────┐     ┌─────┐ ┌─────┐
│             │  →  │ 左  │ │ 右  │
│   横版页面   │     │ 半  │ │ 半  │
│             │     │ 页  │ │ 页  │
└─────────────┘     └─────┘ └─────┘
```

#### 输出顺序
```
输出PDF页面顺序：
1. 封面（纵版）
2. 正文第1页左半页
3. 正文第1页右半页
4. 正文第2页左半页
5. 正文第2页右半页
...
N. 封底（纵版）
```

### 裁剪逻辑说明

**简化裁剪策略**：
- 封面页：自动转为纵版
- 横版正文页：直接对半裁剪为左右两页
- 纵版正文页：保持不变
- 封底页：自动转为纵版

**优势**：
- 逻辑简单明确
- 避免复杂的排版识别
- 适用于大多数小册子格式
- 裁剪结果稳定可靠

---

## 💡 最佳实践

### 准备PDF文件
1. **检查页面方向**：确保封面为横版，正文为横版双页排版
2. **确认页数**：PDF至少需要3页才能正常处理
3. **优化文件大小**：如果文件过大，建议先压缩再上传

### 打印设置建议
1. **纸张尺寸**：A4或Letter
2. **打印方向**：纵向打印
3. **页面缩放**：适合页面大小
4. **双面打印**：推荐使用，节省纸张

### 常见用例

#### 书籍小册子
```
原始PDF结构：
封面（横版） + 正文（横版双页）* N + 封底（横版）

处理后：
封面（纵版） + 正文单页 * 2N + 封底（纵版）
```

#### 宣传手册
```
适用于：产品手册、活动宣传册、教学材料等
特点：封面精美，内页内容密集的双页排版
```

---

## 🛠️ 故障排除

### 常见问题

#### Q1: 上传失败，提示"只支持PDF文件"
**原因**：上传了非PDF格式文件
**解决**：确认文件扩展名为.pdf

#### Q2: 处理失败，提示"PDF至少需要3页"
**原因**：PDF页数不足3页
**解决**：添加更多页面或合并PDF文件

#### Q3: 页面裁剪不正确
**原因**：PDF页面尺寸识别错误
**解决**：检查原始PDF的页面方向设置

#### Q4: 文件过大无法上传
**原因**：超过16MB限制
**解决**：使用PDF压缩工具减小文件大小

### 错误代码说明

| 错误信息 | 原因 | 解决方法 |
|---------|------|----------|
| `文件不存在` | 上传中断或文件损坏 | 重新上传文件 |
| `处理失败` | PDF格式不兼容 | 检查PDF版本和加密状态 |
| `内存不足` | 文件过大或系统资源紧张 | 重启应用或减小文件 |

---

## 🔄 维护和管理

### 清理临时文件
点击"清理临时文件"按钮可以：
- 删除所有上传的原始文件
- 删除所有处理后的输出文件
- 释放磁盘空间

### 重启应用
如果应用出现异常，可以：
1. 在终端中按 `Ctrl+C` 停止当前进程
2. 重新运行 `python3 app.py`

### 更改端口
如果默认端口5001被占用，可以修改 `app.py` 文件：
```python
# 修改这一行中的端口号
app.run(debug=True, host='0.0.0.0', port=5002)  # 改为其他端口
```

---

## 📞 技术支持

### 获取帮助
如果遇到问题，请检查：
1. Python版本是否为3.7+
2. 所有依赖包是否已安装
3. 防火墙是否阻止了端口访问

### 日志查看
应用运行时会在终端输出详细日志，包括：
- 文件上传状态
- 处理进度
- 错误信息

### 联系方式
如有技术问题，请联系开发团队或查看项目文档。

---

## 📋 版本历史

### v1.0.0 (当前版本)
- ✅ 基础PDF裁剪功能
- ✅ Web界面支持
- ✅ 拖拽上传功能
- ✅ 自动页面方向识别
- ✅ 横版双页裁剪

### 未来计划
- 🔄 批量处理多个PDF
- 🔄 自定义裁剪规则
- 🔄 预览功能
- 🔄 更多输出格式支持

---

## 📄 许可证

本项目基于MIT许可证开源，允许自由使用、修改和分发。

---

*最后更新：2025年10月26日*
*版本：v1.0.0*